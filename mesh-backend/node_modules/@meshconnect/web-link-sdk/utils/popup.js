import { getLinkStyle, getNumber } from './style';
var popupId = 'mesh-link-popup';
var backdropId = 'mesh-link-popup__backdrop';
var popupContentId = 'mesh-link-popup__popup-content';
var stylesId = 'mesh-link-popup__styles';
export var iframeId = 'mesh-link-popup__iframe';
var getStylesContent = function (style) { return "\n  body {\n    position: fixed;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    right: 0;\n    overflow: hidden;\n  }\n\n  #".concat(popupId, " {\n    all: unset;\n    position: fixed;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    right: 0;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    z-index: 10000;\n  }\n\n  #").concat(backdropId, " {\n    position: absolute;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    right: 0;\n    z-index: 10000;\n    background: black;\n    opacity: ").concat(getNumber(0.6, style === null || style === void 0 ? void 0 : style.io), ";\n  }\n\n  #").concat(popupContentId, " {\n    position: absolute;\n    height: 80%;\n    max-height: 710px;\n    min-height: 685px;\n    margin: auto;\n    z-index: 10001;\n    width: 30%;\n    max-width: 430px;\n    min-width: 380px;\n    display: flex;\n    flex-direction: column;\n    border-radius: ").concat(getNumber(24, style === null || style === void 0 ? void 0 : style.ir), "px;\n    flex-grow: 1;\n  }\n\n  #").concat(popupContentId, " iframe {\n    border: none;\n    width: 100%;\n    flex-grow: 1;\n    border-radius: ").concat(getNumber(24, style === null || style === void 0 ? void 0 : style.ir), "px;\n  }\n\n  @media only screen and (max-width: 768px) {\n    #").concat(popupContentId, " {\n      height: 100vh;\n      width: 100vw;\n      max-width: 100%;\n      min-width: 100%;\n      max-height: 100%;\n      min-height: 100%;\n      border-radius: 0px;\n    }\n\n    #").concat(popupContentId, " iframe {\n      border-radius: 0px;\n    }\n  }\n\n  @media only screen and (max-height: 710px) {\n    #").concat(popupContentId, " {\n      max-height: 100%;\n      min-height: 100%;\n    }\n  }\n"); };
export function removePopup() {
    var _a, _b;
    var existingPopup = window.document.getElementById(popupId);
    (_a = existingPopup === null || existingPopup === void 0 ? void 0 : existingPopup.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(existingPopup);
    var existingStyles = window.document.getElementById(stylesId);
    (_b = existingStyles === null || existingStyles === void 0 ? void 0 : existingStyles.parentElement) === null || _b === void 0 ? void 0 : _b.removeChild(existingStyles);
}
export function addPopup(iframeLink, language) {
    removePopup();
    var styleElement = document.createElement('style');
    styleElement.id = stylesId;
    var style = getLinkStyle(iframeLink);
    styleElement.textContent = getStylesContent(style);
    window.document.head.appendChild(styleElement);
    iframeLink = "".concat(iframeLink).concat(iframeLink.includes('?') ? '&' : '?', "lng=").concat(language || 'en');
    var popupRootElement = document.createElement('div');
    popupRootElement.id = popupId;
    var popupBackdropElement = document.createElement('div');
    popupBackdropElement.id = backdropId;
    popupRootElement.appendChild(popupBackdropElement);
    var popupContentElement = document.createElement('div');
    popupContentElement.id = popupContentId;
    var iframeElement = document.createElement('iframe');
    iframeElement.id = iframeId;
    iframeElement.src = iframeLink;
    iframeElement.allow = 'clipboard-read *; clipboard-write *';
    popupContentElement.appendChild(iframeElement);
    popupRootElement.appendChild(popupContentElement);
    window.document.body.appendChild(popupRootElement);
}
